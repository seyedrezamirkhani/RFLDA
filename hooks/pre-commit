#!/bin/bash

# Get the list of staged .R files
staged_files=$(git diff --cached --name-only --diff-filter=ACM | grep '\.R$')

# Exit if there are no staged R files
if [ -z "$staged_files" ]; then
  exit 0
fi

# Run styler on each staged file
for file in $staged_files; do
  echo "Styling $file with styler..."
  Rscript -e "styler::style_file('$file')"
  
  # Add the formatted file back to staging area
  git add "$file"
done

# Exit with success status
exit 0

